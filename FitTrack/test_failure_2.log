[INFO] Scanning for projects...
[INFO] 
[INFO] -----------------------< com.fittrack:main-app >------------------------
[INFO] Building FitTrack 0.0.1-SNAPSHOT
[INFO]   from pom.xml
[INFO] --------------------------------[ jar ]---------------------------------
[INFO] 
[INFO] --- jacoco:0.8.11:prepare-agent (default) @ main-app ---
[INFO] argLine set to -javaagent:C:\\Users\\vilis\\.m2\\repository\\org\\jacoco\\org.jacoco.agent\\0.8.11\\org.jacoco.agent-0.8.11-runtime.jar=destfile=C:\\Users\\vilis\\Developer\\SoftUniProject\\FitTrack\\target\\jacoco.exec
[INFO] 
[INFO] --- resources:3.3.1:resources (default-resources) @ main-app ---
[INFO] Copying 1 resource from src\main\resources to target\classes
[INFO] Copying 40 resources from src\main\resources to target\classes
[INFO] 
[INFO] --- compiler:3.13.0:compile (default-compile) @ main-app ---
[INFO] Nothing to compile - all classes are up to date.
[INFO] 
[INFO] --- resources:3.3.1:testResources (default-testResources) @ main-app ---
[INFO] skip non existing resourceDirectory C:\Users\vilis\Developer\SoftUniProject\FitTrack\src\test\resources
[INFO] 
[INFO] --- compiler:3.13.0:testCompile (default-testCompile) @ main-app ---
[INFO] Nothing to compile - all classes are up to date.
[INFO] 
[INFO] --- surefire:3.5.2:test (default-test) @ main-app ---
[INFO] Using auto detected provider org.apache.maven.surefire.junitplatform.JUnitPlatformProvider
[INFO] 
[INFO] -------------------------------------------------------
[INFO]  T E S T S
[INFO] -------------------------------------------------------
[INFO] Running com.fittrack.mainapp.controller.LlmControllerTest
20:33:56.621 [main] INFO org.springframework.test.context.support.AnnotationConfigContextLoaderUtils -- Could not detect default configuration classes for test class [com.fittrack.mainapp.controller.LlmControllerTest]: LlmControllerTest does not declare any static, non-private, non-final, nested classes annotated with @Configuration.
20:33:57.336 [main] INFO org.springframework.boot.test.context.SpringBootTestContextBootstrapper -- Found @SpringBootConfiguration com.fittrack.mainapp.FitTrackApplication for test class com.fittrack.mainapp.controller.LlmControllerTest
20:33:57.775 [main] INFO org.springframework.boot.devtools.restart.RestartApplicationListener -- Restart disabled due to context in which it is running

  .   ____          _            __ _ _
 /\\ / ___'_ __ _ _(_)_ __  __ _ \ \ \ \
( ( )\___ | '_ | '_| | '_ \/ _` | \ \ \ \
 \\/  ___)| |_)| | | | | || (_| |  ) ) ) )
  '  |____| .__|_| |_|_| |_\__, | / / / /
 =========|_|==============|___/=/_/_/_/

 :: Spring Boot ::                (v3.4.0)

2025-11-28T20:33:58.392+02:00  WARN 26428 --- [FitTrack] [           main] ory$DuplicateJsonObjectContextCustomizer : 

Found multiple occurrences of org.json.JSONObject on the class path:

	jar:file:/C:/Users/vilis/.m2/repository/com/vaadin/external/google/android-json/0.0.20131108.vaadin1/android-json-0.0.20131108.vaadin1.jar!/org/json/JSONObject.class
	jar:file:/C:/Users/vilis/.m2/repository/org/json/json/20240303/json-20240303.jar!/org/json/JSONObject.class

You may wish to exclude one of them to ensure predictable runtime behavior

2025-11-28T20:33:58.430+02:00  INFO 26428 --- [FitTrack] [           main] c.f.m.controller.LlmControllerTest       : Starting LlmControllerTest using Java 22.0.1 with PID 26428 (started by vilis in C:\Users\vilis\Developer\SoftUniProject\FitTrack)
2025-11-28T20:33:58.431+02:00  INFO 26428 --- [FitTrack] [           main] c.f.m.controller.LlmControllerTest       : No active profile set, falling back to 1 default profile: "default"
Mockito is currently self-attaching to enable the inline-mock-maker. This will no longer work in future releases of the JDK. Please add Mockito as an agent to your build what is described in Mockito's documentation: https://javadoc.io/doc/org.mockito/mockito-core/latest/org/mockito/Mockito.html#0.3
Java HotSpot(TM) 64-Bit Server VM warning: Sharing is only supported for boot loader classes because bootstrap classpath has been appended
WARNING: A Java agent has been loaded dynamically (C:\Users\vilis\.m2\repository\net\bytebuddy\byte-buddy-agent\1.15.10\byte-buddy-agent-1.15.10.jar)
WARNING: If a serviceability tool is in use, please run with -XX:+EnableDynamicAgentLoading to hide this warning
WARNING: If a serviceability tool is not in use, please run with -Djdk.instrument.traceUsage for more information
WARNING: Dynamic loading of agents will be disallowed by default in a future release
2025-11-28T20:34:02.676+02:00  INFO 26428 --- [FitTrack] [           main] o.s.b.a.w.s.WelcomePageHandlerMapping    : Adding welcome page template: index
2025-11-28T20:34:04.479+02:00  INFO 26428 --- [FitTrack] [           main] o.s.b.t.m.w.SpringBootMockServletContext : Initializing Spring TestDispatcherServlet ''
2025-11-28T20:34:04.480+02:00  INFO 26428 --- [FitTrack] [           main] o.s.t.web.servlet.TestDispatcherServlet  : Initializing Servlet ''
2025-11-28T20:34:04.481+02:00  INFO 26428 --- [FitTrack] [           main] o.s.t.web.servlet.TestDispatcherServlet  : Completed initialization in 1 ms
2025-11-28T20:34:04.803+02:00  INFO 26428 --- [FitTrack] [           main] c.f.m.controller.LlmControllerTest       : Started LlmControllerTest in 7.05 seconds (process running for 10.344)

MockHttpServletRequest:
      HTTP Method = POST
      Request URI = /api/llm/chat
       Parameters = {_csrf=[6FIAT9CeQX9P2im4_QQA5V9_-t_D_JybMW9FOqcacP4k3JUGjGQ4feKpckpi6xDanik0hz4Z1773z6i2Ull9C8IpFs5AuaY_]}
          Headers = [Content-Type:"application/json;charset=UTF-8", Content-Length:"20"]
             Body = {"message": "Hello"}
    Session Attrs = {SPRING_SECURITY_CONTEXT=SecurityContextImpl [Authentication=UsernamePasswordAuthenticationToken [Principal=org.springframework.security.core.userdetails.User [Username=user, Password=[PROTECTED], Enabled=true, AccountNonExpired=true, CredentialsNonExpired=true, AccountNonLocked=true, Granted Authorities=[ROLE_USER]], Credentials=[PROTECTED], Authenticated=true, Details=null, Granted Authorities=[ROLE_USER]]]}

Handler:
             Type = null

Async:
    Async started = false
     Async result = null

Resolved Exception:
             Type = null

ModelAndView:
        View name = null
             View = null
            Model = null

FlashMap:
       Attributes = null

MockHttpServletResponse:
           Status = 200
    Error message = null
          Headers = [X-Content-Type-Options:"nosniff", X-XSS-Protection:"0", Cache-Control:"no-cache, no-store, max-age=0, must-revalidate", Pragma:"no-cache", Expires:"0", X-Frame-Options:"DENY"]
     Content type = null
             Body = 
    Forwarded URL = null
   Redirected URL = null
          Cookies = []
[ERROR] Tests run: 1, Failures: 1, Errors: 0, Skipped: 0, Time elapsed: 9.794 s <<< FAILURE! -- in com.fittrack.mainapp.controller.LlmControllerTest
[ERROR] com.fittrack.mainapp.controller.LlmControllerTest.testChat -- Time elapsed: 0.427 s <<< FAILURE!
java.lang.AssertionError: No value at JSON path "$.response"
	at org.springframework.test.util.JsonPathExpectationsHelper.evaluateJsonPath(JsonPathExpectationsHelper.java:351)
	at org.springframework.test.util.JsonPathExpectationsHelper.assertValue(JsonPathExpectationsHelper.java:148)
	at org.springframework.test.web.servlet.result.JsonPathResultMatchers.lambda$value$2(JsonPathResultMatchers.java:112)
	at org.springframework.test.web.servlet.MockMvc$1.andExpect(MockMvc.java:214)
	at com.fittrack.mainapp.controller.LlmControllerTest.testChat(LlmControllerTest.java:54)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1597)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1597)
Caused by: java.lang.IllegalArgumentException: json can not be null or empty
	at com.jayway.jsonpath.internal.Utils.notEmpty(Utils.java:401)
	at com.jayway.jsonpath.JsonPath.read(JsonPath.java:390)
	at org.springframework.test.util.JsonPathExpectationsHelper.evaluateJsonPath(JsonPathExpectationsHelper.java:348)
	... 7 more

[INFO] 
[INFO] Results:
[INFO] 
[ERROR] Failures: 
[ERROR]   LlmControllerTest.testChat:54 No value at JSON path "$.response"
[INFO] 
[ERROR] Tests run: 1, Failures: 1, Errors: 0, Skipped: 0
[INFO] 
[INFO] ------------------------------------------------------------------------
[INFO] BUILD FAILURE
[INFO] ------------------------------------------------------------------------
[INFO] Total time:  13.957 s
[INFO] Finished at: 2025-11-28T20:34:05+02:00
[INFO] ------------------------------------------------------------------------
[ERROR] Failed to execute goal org.apache.maven.plugins:maven-surefire-plugin:3.5.2:test (default-test) on project main-app: There are test failures.
[ERROR] 
[ERROR] See C:\Users\vilis\Developer\SoftUniProject\FitTrack\target\surefire-reports for the individual test results.
[ERROR] See dump files (if any exist) [date].dump, [date]-jvmRun[N].dump and [date].dumpstream.
[ERROR] -> [Help 1]
[ERROR] 
[ERROR] To see the full stack trace of the errors, re-run Maven with the -e switch.
[ERROR] Re-run Maven using the -X switch to enable full debug logging.
[ERROR] 
[ERROR] For more information about the errors and possible solutions, please read the following articles:
[ERROR] [Help 1] http://cwiki.apache.org/confluence/display/MAVEN/MojoFailureException
